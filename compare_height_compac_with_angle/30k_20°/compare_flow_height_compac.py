import h5py
import math
import numpy as np
import matplotlib.pyplot as plt
import os.path
from os import path
from mpl_toolkits.mplot3d import Axes3D
from collections import Counter
from statistics import mode

h_inst_a30 = [19,18,16,15] 
h_tave_a30 = [18.277227722772277,17.485148514851485,16.287128712871286,15.029702970297029 ]

h_inst_a20 = [24,25,27,26,26,24,13]
h_tave_a20 = [24.77227722772277,25.0,26.15841584158416,26.0,25.495049504950494,24.96039603960396,13.594059405940595]

com_300d_inst_a30 = 0.5*np.array([1.02961176166675, 1.3931400320997553, 1.6138109793692061, 1.388415103702995, 1.3793706384603208, 1.7186254825594012, 1.2394661983377622, 1.875230094547661, 1.734388189273753, 1.8024709524850695, 1.2397639793606816, 1.5757016724078716, 1.5013500788869876, 1.5188924541815865, 1.576752157667086, 0.8601369303753051, 0.31300910645438024, 0.0])
com_500d_inst_a30 = 0.5*np.array([1.5945416405628716, 1.2561284950186706, 2.102693569537819, 1.6007152292950213, 1.323201036788694, 1.6924232372302306, 1.5237065637337162, 1.5382763143653388, 1.5880681474864178, 1.3035111859007606, 2.239186999717887, 1.5278511687512206, 1.2916877115472356, 0.9382338851764458, 1.2346443795421604, 1.0885865298493458, 0.0])
com_700d_inst_a30 = 0.5*np.array([1.4395986012722377, 1.7798015522335688, 1.1552829263278628, 1.3417359567117375, 1.5617057067142643, 1.2373369240418959, 1.243932098992133, 1.3262667807178148, 1.566015829791456, 1.1914497225153282, 1.1720679321579408, 1.4947595898729331, 1.216231241133961, 0.634741014197772, 0.0])
com_900d_inst_a30 = [0.49055410304106434, 0.30381288105657955, 0.297406192278003, 0.5909849057048473, 0.4253260745356369, 0.7034007798493379, 0.8393446925080149, 0.7156974406462543, 0.85782187208078, 0.6834561280338055, 0.5404456114036058, 0.6330394111323574, 0.28038731213504725, 0.0]

com_300d_tave_a30 = [0.5851122474463727, 0.7507292474783036, 0.6968474329882993, 0.8153281984395389, 0.8245344385122778, 0.9017276641347216, 0.5666159529710539, 0.7224467292079468, 0.7437122544565776, 0.8777180526155182, 0.7245228522555187, 0.7526008347466507, 0.7551049016250917, 0.7104324354156262, 0.7486505718022551, 0.4118063725543753, 0.04493695092661895, 0.0]
com_500d_tave_a30 = [0.6365983037691533, 0.8343416431969597, 0.7616848795316219, 0.7174577164395147, 0.7180812349171589, 0.7054728200670848, 0.8332596729570264, 0.7254938437320091, 0.7442216052669923, 0.6864888917681393, 0.8666204673365618, 0.8014197759297736, 0.6240080811272749, 0.5816352059885211, 0.5622415677843369, 0.28102801184394727, 0.0]
com_700d_tave_a30 = [0.7755173881022289, 0.7543922894780478, 0.6462624404714689, 0.6721943342516704, 0.660625400048026, 0.6119797782893047, 0.7893589911857355, 0.8383868633953715, 0.6301798782922643, 0.7291949937304798, 0.7176354227144883, 0.482986481289561, 0.36384319906238904, 0.18403084380635523, 0.0]
com_900d_tave_a30 = [0.32254303158032976, 0.3740160888847978, 0.3806291940880866, 0.49336243245430805, 0.47084716414726013, 0.5641688534285112, 0.596528559705376, 0.6364155217478571, 0.6111666523149146, 0.6791659120813412, 0.5532371399723673, 0.5046118812901689, 0.47379918024448053, 0.19475022053523305]

com_300d_inst_a20 = 0.5*np.array([1.66150919702947, 1.1955770190468515, 1.5116544964146623, 1.3080141246587231, 1.0538754649947746, 1.7595857686180625, 1.7266632527652739, 1.4644529397628252, 1.6697670471169397, 1.5764485826588803, 1.720671219797468, 1.3603235772029827, 1.3711964958928038, 1.77970307611115, 1.7535374919165685, 1.7786400322459979, 1.0499518515743265, 2.0088785166958205, 1.7560017830234724, 1.4851712539103543, 1.518577844248535, 1.2573302293031343, 0.0])
com_400d_inst_a20 = 0.5*np.array([1.6861854977920772, 1.4418880833249537, 1.3492540676151183, 1.8772383608901257, 1.3236823765456673, 1.7425778741150892, 1.3666400651036705, 1.5361855310174244, 1.0948555543194904, 1.624778550402958, 1.5314382012377066, 1.5025620849626666, 1.6273709443993007, 1.354995742237058, 1.623988524980311, 1.1975545394618363, 1.5881421324248786, 1.6600946874233509, 1.0434996517969255, 1.5322357614791673, 2.0361051935119097, 1.3555036503153846, 0.3473061195383788, 0.0])
com_500d_inst_a20 = 0.5*np.array([1.5969937538620114, 1.4979052935543697, 1.4513302039119225, 1.5659019949675312, 1.574714648468664, 1.5410613320684952, 1.686615153312854, 1.4209052490195584, 1.7885316326606673, 1.5537389429262884, 1.3872563356603114, 1.200113062733749, 1.8031874473384006, 1.9378178842073286, 1.624030963050841, 1.8260515054110997, 1.300352868427093, 1.3657038383291549, 1.1996994043188782, 1.6494344095648164, 2.3566049734741608, 1.2720381827692164, 1.1647857294660895, 0.8287986525486177, 0.32078223555946817, 0.0])
com_600d_inst_a20 = 0.5*np.array([1.7048234249153433, 1.3465685140200958, 1.6419664200666082, 1.591538713137307, 1.588083326507052, 1.3247816952455542, 1.2789979984407387, 2.017998798391277, 1.4994042181197407, 1.7287120209186921, 1.5745034959465936, 1.3917560420409298, 1.6049155615979704, 1.1605904993418499, 1.167105040816284, 2.8517470061727597, 1.5497602410368367, 1.4729368271322014, 1.5876483465960713, 1.3792225342571973, 1.4349914191212874, 1.6116644977608547, 1.5461796844904854, 1.5834641737828072, 0.0])
com_700d_inst_a20 = 0.5*np.array([1.399267064092151, 1.6703563579765057, 1.4793641932911676, 1.6609822584408858, 2.086813156604756, 1.2341438086873717, 1.59883699446548, 1.6060617886561643, 1.3134364794591697, 1.9975168149266138, 0.9521236733907642, 2.0400143301246656, 1.7626077790552293, 1.1774201879195636, 1.324201765800574, 1.7849403679656173, 1.6993657748743858, 1.3429550561708696, 1.8219381908914143, 1.6701027992215558, 1.2537206123896447, 1.5503261780643223, 1.368684544890494, 1.0143876770520615, 0.0])
com_800d_inst_a20 = 0.5*np.array([1.7606610323526184, 1.2245871061653588, 1.3394970273800977, 1.6725899170031837, 1.2385953158189589, 1.9377671773743377, 1.7449598280619183, 1.547011388938363, 1.9934466981004715, 1.6697945588866385, 1.3399966403821708, 1.960592529496118, 1.8453060247037845, 1.083218735768054, 1.5905996741390525, 1.4555426944328764, 1.7319840069684098, 1.683064008624837, 1.3461072177252893, 1.1404620614746919, 2.0398723977353383, 1.2012810968140522, 0.0])
com_900d_inst_a20 = [0.741969220727107, 0.5983791508956019, 0.9008067392393831, 0.6700654884214566, 0.4658426044906597, 0.7712005911976748, 0.7230053473261254, 0.6441481853769107, 0.7483339960658479, 0.46574969741097166, 0.4606117121844387, 0.13685781845136388]

com_300d_tave_a20 = [0.7769263083353122, 0.747281666325006, 0.7641083561579336, 0.7791479901993771, 0.6483892120346331, 0.7213843036159089, 0.8941510211005302, 0.8163694288315061, 0.8882293393152816, 0.7919462112457603, 0.7744600186224324, 0.6178886443612708, 0.9237414402530053, 0.8823258075905641, 0.8740005405457313, 0.7084629576326352, 0.8891073104560526, 1.0156500100178811, 0.7801184695240445, 0.854736756978284, 0.7261429386843391, 0.7205507057487958, 0.3025370319039559]
com_400d_tave_a20 = [0.8535608736118243, 0.761641962880636, 0.633995261145482, 0.8702542642084248, 0.8004630079475109, 0.7403600794258727, 0.7984172480809442, 0.8722417496448065, 0.6812554032689092, 0.7734158812756886, 1.052921448665924, 0.6436465814287461, 0.7106904253669073, 0.8112092075395859, 0.8208861213677378, 0.6434974353565256, 0.7106054025605903, 0.7869753086782455, 0.7947294937238333, 0.775889837757102, 0.8818202781874551, 0.72982443080617, 0.37086186714359237, 0.038129463316144946]
com_500d_tave_a20 = [0.8469334563102178, 0.6976080080844413, 0.7016809281506919, 0.7810449851323151, 0.8560592415728092, 0.7734785468543722, 0.7711423511577571, 0.9087014097733003, 0.7264115771627755, 0.7550257899850497, 0.7364795041106895, 0.8144040078837308, 0.9827079682196996, 0.872706636768752, 0.70274052375088, 0.8276416823493152, 0.7801985384077307, 0.652112803660438, 0.7188548959155152, 0.7673680111951581, 0.7833436924253812, 0.7603740555814381, 0.7646530757271595, 0.523206668520858, 0.08803449678397261, 0.0]
com_600d_tave_a20 = [0.8766681496256419, 0.7568636874096124, 0.7971697993014079, 0.7044394028143974, 0.7183532081111701, 0.7058927590533205, 0.7132952086573087, 0.7859963898931529, 0.7649280381834002, 0.7417204471145405, 0.7765891556938747, 0.9826317255420927, 0.9102387499199462, 0.7836430868635199, 0.6896134797728254, 0.8937188890501135, 0.6442219629417264, 0.7740739264280723, 0.8087155704989518, 0.7856964224306646, 0.741360007422696, 0.8787371030567078, 0.6033457602262791, 0.5280755091781568, 0.0]
com_700d_tave_a20 = [0.7279025085187373, 0.721777871236696, 0.746162699291601, 0.8635106872663305, 0.8466747106686985, 0.7373238073135703, 0.8378212217535531, 0.7862634294207081, 0.8231058791716587, 0.8818882921724938, 0.5750267885381444, 0.9056960005841705, 0.630837748512177, 0.6869606336831886, 0.7352395564677693, 0.816455350170126, 0.8950708466167695, 0.6942393592859464, 0.9409769722360295, 0.702744257312102, 0.7778767049203785, 0.6392164076174998, 0.5189941514335742, 0.14797481881382613, 0.0]
com_800d_tave_a20 = [0.8521716389824736, 0.7113633097510003, 0.7164356001771046, 0.6176694402724238, 0.7209440568930883, 0.8182894825447447, 0.8368280203727643, 0.8060090285102303, 0.8709263253476777, 0.7205534294293661, 0.7314231522831279, 0.8834787586411814, 0.7553331886610439, 0.7766875359238208, 0.7728189606384672, 0.9092155269114687, 0.7973214333085515, 0.7302344589621695, 0.6908944984302067, 0.6262143359467917, 0.8751103941615642, 0.6715925491113107, 0.3616690458574484]
com_900d_tave_a20 = [0.5506466809732635, 0.5509745105481467, 0.6590807866782668, 0.6376704873972056, 0.6014309020360339, 0.7046648117161564, 0.7413206424331955, 0.7607149089647858, 0.6539622909336278, 0.5480379680248029, 0.43709522967493974, 0.18033753972648334]

pos_a30 = [300,500,700,900]
pos_a20 = [300,400,500,600,700,800,900]

#flow_height
plt.figure(1)
plt.plot(pos_a30,h_inst_a30,'ro-',label='h_instantaneous_angle-{}'.format(30))
plt.plot(pos_a30,h_tave_a30,'ro--',label='h_time-averaged_angle-{}'.format(30))
plt.plot(pos_a20,h_inst_a20,'go-',label='h_instantaneous_angle-{}'.format(20))
plt.plot(pos_a20,h_tave_a20,'go--',label='h_time-averaged_angle-{}'.format(20))
plt.legend()
plt.suptitle(' Flow_height versus time',fontsize=15)
plt.xlabel('time t(s)')
plt.ylabel('y/d')

#compacity
profil_com_fig, com_graphs      = plt.subplots(2,2,figsize=(20, 10), sharey=True, sharex=True)

profil_com_fig.suptitle('Profil_compacity for angle 30째 and then 20째')

#30째
#instantaneous
com_graphs[0,0].plot(com_300d_inst_a30,np.arange(0,len(com_300d_inst_a30),1),'-o',label = ' com_300d_inst_a30')
com_graphs[0,0].plot(com_500d_inst_a30,np.arange(0,len(com_500d_inst_a30),1),'-o',label = ' com_500d_inst_a30')
com_graphs[0,0].plot(com_700d_inst_a30,np.arange(0,len(com_700d_inst_a30),1),'-o',label = ' com_700d_inst_a30')
com_graphs[0,0].plot(com_900d_inst_a30,np.arange(0,len(com_900d_inst_a30),1),'-o',label = ' com_900d_inst_a30')
com_graphs[0,0].legend()
com_graphs[0,0].set_title('instantaneous_angle={}'.format(30))
com_graphs[0,0].set_xlabel('Fraction_volume')
com_graphs[0,0].set_ylabel('y/d')
#time-averaged
com_graphs[0,1].plot(com_300d_tave_a30,np.arange(0,len(com_300d_tave_a30),1),'--o',label = ' com_300d_tave_a30')
com_graphs[0,1].plot(com_500d_tave_a30,np.arange(0,len(com_500d_tave_a30),1),'--o',label = ' com_500d_tave_a30')
com_graphs[0,1].plot(com_700d_tave_a30,np.arange(0,len(com_700d_tave_a30),1),'--o',label = ' com_700d_tave_a30')
com_graphs[0,1].plot(com_900d_tave_a30,np.arange(0,len(com_900d_tave_a30),1),'--o',label = ' com_900d_tave_a30')
com_graphs[0,1].legend()
com_graphs[0,1].set_title('time-averaged_angle={}'.format(30))
com_graphs[0,1].set_xlabel('Fraction_volume')
com_graphs[0,1].set_ylabel('y/d')

#20째
#instantaneous
com_graphs[1,0].plot(com_300d_inst_a20,np.arange(0,len(com_300d_inst_a20),1),'-o',label = ' com_300d_inst_a20')
#com_graphs[1,0].plot(com_400d_inst_a20,np.arange(0,len(com_400d_inst_a20),1),'-o',label = ' com_400d_inst_a20')
com_graphs[1,0].plot(com_500d_inst_a20,np.arange(0,len(com_500d_inst_a20),1),'-o',label = ' com_500d_inst_a20')
#com_graphs[1,0].plot(com_600d_inst_a20,np.arange(0,len(com_600d_inst_a20),1),'-o',label = ' com_600d_inst_a20')
com_graphs[1,0].plot(com_700d_inst_a20,np.arange(0,len(com_700d_inst_a20),1),'-o',label = ' com_700d_inst_a20')
#com_graphs[1,0].plot(com_800d_inst_a20,np.arange(0,len(com_800d_inst_a20),1),'-o',label = ' com_800d_inst_a20')
com_graphs[1,0].plot(com_900d_inst_a20,np.arange(0,len(com_900d_inst_a20),1),'-o',label = ' com_900d_inst_a20')
com_graphs[1,0].legend()
com_graphs[1,0].set_title('instantaneous_angle={}'.format(20))
com_graphs[1,0].set_xlabel('Fraction_volume')
com_graphs[1,0].set_ylabel('y/d')
#time-averaged
com_graphs[1,1].plot(com_300d_tave_a20,np.arange(0,len(com_300d_tave_a20),1),'-o',label = ' com_300d_tave_a20')
#com_graphs[1,1].plot(com_400d_tave_a20,np.arange(0,len(com_400d_tave_a20),1),'-o',label = ' com_400d_tave_a20')
com_graphs[1,1].plot(com_500d_tave_a20,np.arange(0,len(com_500d_tave_a20),1),'-o',label = ' com_500d_tave_a20')
#com_graphs[1,1].plot(com_600d_tave_a20,np.arange(0,len(com_600d_tave_a20),1),'-o',label = ' com_600d_tave_a20')
com_graphs[1,1].plot(com_700d_tave_a20,np.arange(0,len(com_700d_tave_a20),1),'-o',label = ' com_700d_tave_a20')
#com_graphs[1,1].plot(com_800d_tave_a20,np.arange(0,len(com_800d_tave_a20),1),'-o',label = ' com_800d_tave_a20')
com_graphs[1,1].plot(com_900d_tave_a20,np.arange(0,len(com_900d_tave_a20),1),'-o',label = ' com_900d_tave_a20')
com_graphs[1,1].legend()
com_graphs[1,1].set_title('time-averaged_angle={}'.format(20))
com_graphs[1,1].set_xlabel('Fraction_volume')
com_graphs[1,1].set_ylabel('y/d')

plt.show()
